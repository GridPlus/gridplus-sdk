version: '3.4'

services:

  # install:
  #   image: node:9-alpine
  #   environment:
  #     - NPM_TOKEN=${NPM_TOKEN}
  #   volumes:
  #     - .:/usr/src/service
  #     # - /usr/local/lib/node_modules:/usr/local/lib/node_modules
  #     # - /usr/local/lib/node_modules/@gridplus/mqtt-client:/usr/local/lib/node_modules/@gridplus/mqtt-client
  #   working_dir: /usr/src/service
  #   privileged: true
  #   user: node
  #   command: /usr/local/bin/npm i

  # test:
  #   image: node:9-alpine
  #   environment:
  #     - NPM_TOKEN=${NPM_TOKEN}
  #   volumes:
  #     - .:/usr/src/service
  #     # - /usr/local/lib/node_modules:/usr/local/lib/node_modules
  #     # - /usr/local/lib/node_modules/@gridplus/mqtt-client:/usr/local/lib/node_modules/@gridplus/mqtt-client
  #   working_dir: /usr/src/service
  #   privileged: true
  #   user: node
  #   command: /usr/local/bin/npm test
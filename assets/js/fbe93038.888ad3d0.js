"use strict";(self.webpackChunkgridplus_sdk_docs=self.webpackChunkgridplus_sdk_docs||[]).push([[8432],{3905:function(t,e,n){n.d(e,{Zo:function(){return d},kt:function(){return g}});var a=n(7294);function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function i(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function l(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?i(Object(n),!0).forEach((function(e){r(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function o(t,e){if(null==t)return{};var n,a,r=function(t,e){if(null==t)return{};var n,a,r={},i=Object.keys(t);for(a=0;a<i.length;a++)n=i[a],e.indexOf(n)>=0||(r[n]=t[n]);return r}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(a=0;a<i.length;a++)n=i[a],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}var s=a.createContext({}),p=function(t){var e=a.useContext(s),n=e;return t&&(n="function"==typeof t?t(e):l(l({},e),t)),n},d=function(t){var e=p(t.components);return a.createElement(s.Provider,{value:e},t.children)},m={inlineCode:"code",wrapper:function(t){var e=t.children;return a.createElement(a.Fragment,{},e)}},u=a.forwardRef((function(t,e){var n=t.components,r=t.mdxType,i=t.originalType,s=t.parentName,d=o(t,["components","mdxType","originalType","parentName"]),u=p(n),g=r,f=u["".concat(s,".").concat(g)]||u[g]||m[g]||i;return n?a.createElement(f,l(l({ref:e},d),{},{components:n})):a.createElement(f,l({ref:e},d))}));function g(t,e){var n=arguments,r=e&&e.mdxType;if("string"==typeof t||r){var i=n.length,l=new Array(i);l[0]=u;var o={};for(var s in e)hasOwnProperty.call(e,s)&&(o[s]=e[s]);o.originalType=t,o.mdxType="string"==typeof t?t:r,l[1]=o;for(var p=2;p<i;p++)l[p]=n[p];return a.createElement.apply(null,l)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},4534:function(t,e,n){n.r(e),n.d(e,{assets:function(){return d},contentTitle:function(){return s},default:function(){return g},frontMatter:function(){return o},metadata:function(){return p},toc:function(){return m}});var a=n(7462),r=n(3366),i=(n(7294),n(3905)),l=["components"],o={},s="\ud83e\uddea Testing",p={unversionedId:"testing",id:"testing",title:"\ud83e\uddea Testing",description:"All functionality is tested in some script in /test. Please see those scripts for examples on functionality not documented.",source:"@site/docs/testing.md",sourceDirName:".",slug:"/testing",permalink:"/gridplus-sdk/testing",draft:!1,editUrl:"https://github.com/gridplus/gridplus-sdk/docs/testing.md",tags:[],version:"current",frontMatter:{},sidebar:"sidebar",previous:{title:"\ud83e\uddfe Signing Transactions and Messages",permalink:"/gridplus-sdk/signing"},next:{title:"Class: Client",permalink:"/gridplus-sdk/api/classes/client.Client"}},d={},m=[{value:"Setting up a test connection",id:"setting-up-a-test-connection",level:2},{value:"Global <code>env</code> Options",id:"global-env-options",level:2},{value:"Setting up the <code>.env</code> file",id:"setting-up-the-env-file",level:2},{value:"Firmware Test Runner",id:"firmware-test-runner",level:2},{value:"Reference: Tests and Options",id:"reference-tests-and-options",level:2}],u={toc:m};function g(t){var e=t.components,n=(0,r.Z)(t,l);return(0,i.kt)("wrapper",(0,a.Z)({},u,n,{components:e,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"-testing"},"\ud83e\uddea Testing"),(0,i.kt)("p",null,"All functionality is tested in some script in ",(0,i.kt)("inlineCode",{parentName:"p"},"/test"),". Please see those scripts for examples on functionality not documented."),(0,i.kt)("admonition",{type:"caution"},(0,i.kt)("p",{parentName:"admonition"},"Testing is only possible with a development Lattice, which GridPlus does not distribute publicly. Therefore, if you do not have a development Lattice, you will not be able to run many of these tests.**")),(0,i.kt)("h2",{id:"setting-up-a-test-connection"},"Setting up a test connection"),(0,i.kt)("p",null,"Only one test can be run against an unpaired Lattice: ",(0,i.kt)("inlineCode",{parentName:"p"},"npm run test"),". Therefore this must be run before running any other tests. If you wish to run additional tests, you need to specify the following:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"env REUSE_KEY=1 npm run test\n")),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"REUSE_KEY")," will save the connection locally so you can run future tests. Running this test will ask for your device ID and will go through the pairing process. After pairing, the rest of the script will test a broad range of SDK functionality."),(0,i.kt)("p",null,"To use the connection you've established with any test (including this initial one), you need to include your ",(0,i.kt)("inlineCode",{parentName:"p"},"DEVICE_ID")," as an env argument:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"env DEVICE_ID='mydeviceid' npm run test\n")),(0,i.kt)("h2",{id:"global-env-options"},"Global ",(0,i.kt)("inlineCode",{parentName:"h2"},"env")," Options"),(0,i.kt)("p",null,"The following options can be used after ",(0,i.kt)("inlineCode",{parentName:"p"},"env")," with any test."),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:"left"},"Param"),(0,i.kt)("th",{parentName:"tr",align:"left"},"Options"),(0,i.kt)("th",{parentName:"tr",align:"left"},"Description"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("inlineCode",{parentName:"td"},"REUSE_KEY")),(0,i.kt)("td",{parentName:"tr",align:"left"},"Must be ",(0,i.kt)("inlineCode",{parentName:"td"},"1")),(0,i.kt)("td",{parentName:"tr",align:"left"},"Indicates we will be creating a new pairing with a Lattice and stashing that connection")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("inlineCode",{parentName:"td"},"DEVICE_ID")),(0,i.kt)("td",{parentName:"tr",align:"left"},"A six character string"),(0,i.kt)("td",{parentName:"tr",align:"left"},"The device ID of the target Lattice")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("inlineCode",{parentName:"td"},"ETHERSCAN_KEY")),(0,i.kt)("td",{parentName:"tr",align:"left"},"Any string"),(0,i.kt)("td",{parentName:"tr",align:"left"},"API key for making requests to Etherscan. This is needed specifically for ",(0,i.kt)("inlineCode",{parentName:"td"},"e2e-sign-evm-abi"),".")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("inlineCode",{parentName:"td"},"name")),(0,i.kt)("td",{parentName:"tr",align:"left"},'Any 5-25 character string (default="SDK Test")'),(0,i.kt)("td",{parentName:"tr",align:"left"},"The name of the pairing you will create")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("inlineCode",{parentName:"td"},"baseUrl")),(0,i.kt)("td",{parentName:"tr",align:"left"},'Any URL (default="',(0,i.kt)("a",{parentName:"td",href:"https://signing.gridpl.us%22"},'https://signing.gridpl.us"'),")"),(0,i.kt)("td",{parentName:"tr",align:"left"},"URL describing where to send HTTP requests. Should be changed if your Lattice is on non-default message routing infrastructure.")))),(0,i.kt)("h2",{id:"setting-up-the-env-file"},"Setting up the ",(0,i.kt)("inlineCode",{parentName:"h2"},".env")," file"),(0,i.kt)("p",null,"Alternatively, you may input ",(0,i.kt)("inlineCode",{parentName:"p"},"env")," options into a ",(0,i.kt)("inlineCode",{parentName:"p"},".env")," file to make it easier to run scripts. To create your ",(0,i.kt)("inlineCode",{parentName:"p"},".env")," file, follow these steps:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Copy the ",(0,i.kt)("inlineCode",{parentName:"li"},".env.template")," file."),(0,i.kt)("li",{parentName:"ol"},"Rename the ",(0,i.kt)("inlineCode",{parentName:"li"},".env.template")," file to ",(0,i.kt)("inlineCode",{parentName:"li"},".env"),"."),(0,i.kt)("li",{parentName:"ol"},"Update the desired params in that file, probably your ",(0,i.kt)("inlineCode",{parentName:"li"},"DEVICE_ID"),".")),(0,i.kt)("h2",{id:"firmware-test-runner"},"Firmware Test Runner"),(0,i.kt)("p",null,"Several tests require dev Lattice firmware with the following flag in the root ",(0,i.kt)("inlineCode",{parentName:"p"},"CMakeLists.txt"),":"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"FEATURE_TEST_RUNNER=1\n")),(0,i.kt)("p",null,"See table in the next section."),(0,i.kt)("h2",{id:"reference-tests-and-options"},"Reference: Tests and Options"),(0,i.kt)("p",null,"You can run the following tests with ",(0,i.kt)("inlineCode",{parentName:"p"},"npm run <test name>"),"."),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:"left"},"Test"),(0,i.kt)("th",{parentName:"tr",align:"left"},"Description"),(0,i.kt)("th",{parentName:"tr",align:"left"},"Requires ",(0,i.kt)("inlineCode",{parentName:"th"},"FEATURE_TEST_RUNNER=1")))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("inlineCode",{parentName:"td"},"test")),(0,i.kt)("td",{parentName:"tr",align:"left"},"Runs integration tests. Does not use Lattice."),(0,i.kt)("td",{parentName:"tr",align:"left"},"No")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("inlineCode",{parentName:"td"},"test-unit")),(0,i.kt)("td",{parentName:"tr",align:"left"},"Runs SDK unit tests. Does not use Lattice."),(0,i.kt)("td",{parentName:"tr",align:"left"},"No")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("inlineCode",{parentName:"td"},"e2e")),(0,i.kt)("td",{parentName:"tr",align:"left"},"Runs all end-to-end tests."),(0,i.kt)("td",{parentName:"tr",align:"left"},"Yes")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("inlineCode",{parentName:"td"},"e2e-btc")),(0,i.kt)("td",{parentName:"tr",align:"left"},"Tests BTC signatures (legacy signing)"),(0,i.kt)("td",{parentName:"tr",align:"left"},"Yes")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("inlineCode",{parentName:"td"},"e2e-eth")),(0,i.kt)("td",{parentName:"tr",align:"left"},"Tests EIP712 and ",(0,i.kt)("inlineCode",{parentName:"td"},"personal_sign")," messages (legacy signing)"),(0,i.kt)("td",{parentName:"tr",align:"left"},"No")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("inlineCode",{parentName:"td"},"e2e-gen")),(0,i.kt)("td",{parentName:"tr",align:"left"},"Tests seveal Lattice message routes and some SDK functionality. Bit of a legacy test but still useful."),(0,i.kt)("td",{parentName:"tr",align:"left"},"No")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("inlineCode",{parentName:"td"},"e2e-kv")),(0,i.kt)("td",{parentName:"tr",align:"left"},"Tests KV-files, which are used primarily for tags."),(0,i.kt)("td",{parentName:"tr",align:"left"},"No")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("inlineCode",{parentName:"td"},"e2e-ne")),(0,i.kt)("td",{parentName:"tr",align:"left"},"Tests non-exportable seeded SafeCards (legacy)."),(0,i.kt)("td",{parentName:"tr",align:"left"},"No")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("inlineCode",{parentName:"td"},"e2e-sign")),(0,i.kt)("td",{parentName:"tr",align:"left"},"Runs all signing tests."),(0,i.kt)("td",{parentName:"tr",align:"left"},"Yes")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("inlineCode",{parentName:"td"},"e2e-sign-determinism")),(0,i.kt)("td",{parentName:"tr",align:"left"},"Tests determinism of signatures using known seed loading."),(0,i.kt)("td",{parentName:"tr",align:"left"},"Yes")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("inlineCode",{parentName:"td"},"e2e-sign-evm-abi")),(0,i.kt)("td",{parentName:"tr",align:"left"},"Tests ABI decoding and fetching for EVM transactions."),(0,i.kt)("td",{parentName:"tr",align:"left"},"Yes")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("inlineCode",{parentName:"td"},"e2e-sign-evm-tx")),(0,i.kt)("td",{parentName:"tr",align:"left"},"Tests EVM transaction types."),(0,i.kt)("td",{parentName:"tr",align:"left"},"Yes")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("inlineCode",{parentName:"td"},"e2e-sign-solana")),(0,i.kt)("td",{parentName:"tr",align:"left"},"Tests Solana transactions and address derivation."),(0,i.kt)("td",{parentName:"tr",align:"left"},"Yes")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("inlineCode",{parentName:"td"},"e2e-sign-unformatted")),(0,i.kt)("td",{parentName:"tr",align:"left"},"Tests signing unformatted payloads (ASCII or hex strings)."),(0,i.kt)("td",{parentName:"tr",align:"left"},"Yes")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("inlineCode",{parentName:"td"},"e2e-wj")),(0,i.kt)("td",{parentName:"tr",align:"left"},"Tests wallet jobs, validating path derivations, seed management, etc."),(0,i.kt)("td",{parentName:"tr",align:"left"},"Yes")))))}g.isMDXComponent=!0}}]);